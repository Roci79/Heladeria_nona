{% extends 'helados/index.html' %}

{% block header %}

    <div class="jumbotron jumbotron-fluid page-header" style="margin-bottom: 90px;">
        <div class="container text-center py-5">
            <h1 class="text-white display-3 mt-lg-5">Productos</h1>
            <div class="d-inline-flex align-items-center text-white">
                <p class="m-0"><a class="text-white" href="{% url 'productos' %}">Elaboración Propia</a></p>
                <i class="fa fa-circle px-3"></i>
                <p class="m-0"><a class="text-white" href="{% url 'sabor' %}">Sabores</a></p>
            </div>
        </div>
    </div>
   

{% endblock %}
    <!-- Header End -->

{% block section %}
{% load static %}
<!-- Products Start -->
<div class="container-fluid py-5">
    <div class="container py-5">
        <input type="text" id="buscador" class="form-control ml-auto" style="width: 300px; height: 40px; border-radius: 20px; padding-left: 40px; background-image: url('https://cdn.jsdelivr.net/npm/bootstrap-icons/icons/search.svg'); background-size: 20px; background-position: 10px 50%; background-repeat: no-repeat;" placeholder="Buscar helado por nombre...">
        <div class="row justify-content-center">
            <div class="col-lg-6">
                <h1 class="section-title position-relative text-center mb-5">Este día se merece un toque de sabor.</h1>
                <p style="text-align: center;">Cucuruchos sorpresa tu pones el sabor nosotros el resto.</p>
            </div>
        </div>
        <div class="row justify-content-center">
            <div class="col-lg-3 col-md-6 mb-4 pb-2">
                <div class="product-item d-flex flex-column align-items-center text-center bg-light rounded py-5 px-3">
                    <div class="bg-primary mt-n5 py-3" style="width: 80px;">
                        <h4 class="font-weight-bold text-white mb-0">In</h4>
                    </div>
                    <div class="position-relative bg-primary rounded-circle mt-n3 mb-4 p-3" style="width: 150px; height: 150px;">
                        <img class="rounded-circle w-100 h-100" src="{% static 'helados/img/cono.jpg' %}" style="object-fit: cover;">
                    </div>
                    <h5 class="font-weight-bold mb-4">Cucurucho</h5>
                    <a href="{% url 'detalle_recipiente' %}" class="text-decoration-none text-pink">Ingredientes y más</a>
                </div>
            </div>
        </div>

            <div class="row">
                {% for sabor in lista_sabores %}
                    <div class="col-lg-3 col-md-6 mb-4 pb-2 product-item">
                        <div class="product-item d-flex flex-column align-items-center text-center bg-light rounded py-5 px-3">
                            <div class="bg-primary mt-n5 py-3" style="width: 80px;">
                                <h4 class="font-weight-bold text-white mb-0">{{ sabor.precio }}€</h4>
                            </div>
                            <div class="position-relative bg-primary rounded-circle mt-n3 mb-4 p-3" style="width: 150px; height: 150px;">
                                {% if sabor.foto %}
                                <img class="rounded-circle w-100 h-100" src="{{ sabor.foto.url }}" style="object-fit: cover;">
                                {% else %}
                                <img class="rounded-circle w-100 h-100" src="{% static 'helados/img/product-4.jpg' %}" style="object-fit: cover;">
                                {% endif %}
                            </div>
                            <h5 class="font-weight-bold mb-4">{{ sabor.nombre }}</h5> 
                            <form method="POST" action="{% url 'carro' 'sabor' sabor.id %}">
                                {% csrf_token %}
                                <button type="submit" class="btn btn-sm btn-secondary">Añadir</button>
                            </form>
                            <br>
                            <div class="form-group">
                                <a href="{% url 'detalle_sabores' sabor.id %}" class="text-decoration-none text-pink">Ingredientes y más</a>               
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
    </div>
</div>
<!-- Products End -->

<script>

        document.addEventListener('keyup', e => {
            if (e.target.matches('#buscador')) {
                const searchTerm = e.target.value.trim().toLowerCase();
                const productItems = document.querySelectorAll('.product-item');
    
                productItems.forEach(item => {
                    const productName = item.querySelector('h5').textContent.trim().toLowerCase();
                    if (productName.includes(searchTerm)) {
                        item.style.display = '';
                    } else {
                        item.style.display = 'none';
                    }
                });
            }
        });

        window.addEventListener("beforeunload", function() {
            localStorage.setItem("scrollPosition", window.scrollY);
        });
        window.addEventListener("load", function() {
            const scrollPosition = localStorage.getItem("scrollPosition");
            if (scrollPosition) {
                window.scrollTo(0, parseInt(scrollPosition, 10));
            }
        });

    </script>

    



{% endblock %}






